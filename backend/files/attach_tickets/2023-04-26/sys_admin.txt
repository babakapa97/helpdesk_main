      Занятие 7. Присоединение компьютера к домену
      В стандартной конфигурации Windows Server 2003 и всех ОС Microsoft Windows компьютер принадлежит какой-либо рабочей группе (workgroup). В рабочей группе компьютер на базе Windows NT (включая Windows NT 4, 2000, ХР и Windows Server 2003) может проверять подлинность пользователей только из своей локальной БД диспетчера учетных записей безопасности (Security Accounts Manager, SAM). Такая система автономна во всех смыслах. Принадлежность к рабочей группе позволяет лишь видеть список компьютеров своей группы в Проводнике. Хотя пользователь такого компьютера и может подсоединяться к общим ресурсам на других машинах в рабочих группах или доменах, он на самом деле не входит в систему под доменной учетной записью.
      Чтобы пользователь входил в систему под доменной учетной записью, компьютер должен принадлежать какому-нибудь домену: необходимо создать учетную запись компьютера и настроить его для присоединения к домену по этой учетной записи, чему и посвящено это занятие.
Учетная запись компьютера, как и учетная запись пользователя, содержит имя, пароль и идентификатор безопасности (security identifier, SID). Эти свойства встроены в класс объекта компьютера в Active Directory. Подготовка к включению компьютера в домен, таким образом, очень похожа на подготовку объекта пользователя для добавления в домен: вам нужно создать в Active Directory объект компьютера.
      Для создания объекта компьютера в Active Directory необходимо быть членом групп Администраторы (Administrators) или Операторыучета (Account Operators) на контроллерах домена. Члены групп Администраторы домена (Domain Admins) и Администраторы предприятия (Enterprise Admins) по умолчанию являются участниками группы Администраторы (Administrators). Также можно делегировать административные права, чтобы другие пользователи или группы могли создавать объекты компьютеров.
      Впрочем, пользователи домена также могут создавать объекты компьютеров косвенным путем. Когда компьютер присоединяется к домену, а учетная запись еще не создана, Active Directory по умолчанию автоматически создает объект компьютера в контейнере Computers. Каждому пользователю из группы Прошедшие проверку (Authenticated Users) (то есть всем пользователям) разрешается присоединять к домену до 10 компьютеров и, следовательно, создавать до 10 объектов компьютеров.
      Создание объектов компьютеров в консоли Active Directory • пользователи и компьютеры
      Чтобы создать объект компьютера, или его учетную запись, откройте консоль Active Directory- пользователи и компьютеры (Active Directory Users And Computers) и выберите контейнер или ОП, в котором нужно создать объект. В меню Действие (Action) или в контекстном меню выберите команду Создат» (New)\Koмпьютер (Computer). Откроется диалоговое окно Новый объект — Компьютер (New Object-Computer), показанное на рис. 5-1.


Рис. 5-1. Диалоговое окно Новый объект — Компьютер

      В окне Новый объект — Компьютер (New Object—Computer) введите имя компьютера. Другие свойства из этого окна обсуждаются на следующем занятии. Щелкните Далее (Next). На следующем шаге запрашивается глобально уникальный идентификатор (GUID). GUID используется для предварительной настройки учетной записи компьютера для развертывания системы с помощью служб удаленной установки (Remote Installation Services, RIS). Здесь этот процесс не обсуждается. При создании учетной записи компьютера, который будет присоединяться к домену другими способами, вводить GUID не требуется . Поэтому просто щелкните Далее (Next), а затем Готово (Finish).
      
      Создание объектов компьютеров командой DSADD
      Скорее всего, вам уже доводилось делать нечто подобное. Но прогресс не стоит на месте — Windows Server 2003 предоставляет удобную команду DSADD, позволяющую создавать объекты компьютеров из командной строки или в ходе выполнения командного файла.
      В главе 2 команда DSADD использовалась для создания объектов пользователей. Для создания объекта компьютера просто введите dsadd computer DN_компьютера..., где DN_компьютера,.. — это различающееся имя данного компьютера, например CN=Desktopl23, OU=Desktops, DC=contoso, DC=com.
      Если в DN компьютера есть пробел, заключите все имя в кавычки. Параметр DN_компьютера... может включать множество различающихся имен для новых объектов компьютеров, что делает команду DSADD Computer удобным средством для массовой генерации таких объектов. Этот параметр можно вводить следующими способами: 
* Передача по каналу списка DN-имен, полученного при выполнении другой команды, например DSQUERY.
* Указание всех DN-имен в командной строке через пробел.
* Без указания параметра DN: тогда вы сможете ввести все DN-имена по одному с клавиатуры в ответ на приглашение команды. Нажимайте Enter после ввода каждого DN. Нажмите Ctrl+Z и затем Enter после ввода последнего DN.

      Для команды DSADD Computer после DN можно указать следующие необязательные параметры.
* samid имя_8АМ;
* desc описание;
* loc размещение..
      
      Создание учетной записи компьютера командой NETDOM
      Программа NETDOM входит в комплект средств поддержки и устанавливается из каталога Support\Tools компакт-диска Windows Server 2003. Эта программа также содержится на компакт-дисках Windows 2000 и ХР. Используйте версию, подходящую для вашей платформы. Команда NETDOM позволяет выполнять из командной строки множество операций, связанных с учетными записями доменов и безопасностью.
      Чтобы создать в домене учетную запись компьютера, введите следующую команду:
Nefdom add имя_компьютера / domain:имя_домена /userd:пользователь / PasswordD:пароль_пользователя [/ои:DN_ОП]
      
      Эта команда создает учетную запись для компьютера имя компьютера в домене имя_домена от имени пользователя домена с паролем пароль_пользователя. Параметр /ои приводит к созданию объекта в ОП с различающимся именем DN_OII. Если имя целевого ОП не указано, по умолчанию учетная запись компьютера создается в контейнере Computers. Безусловно, инициатор команды должен обладать разрешениями на создание объектов компьютеров.
      
      Присоединение компьютера к домену
      Собственно учетной записи компьютера недостаточно для создания необходимых безопасных отношений между доменом и компьютером. Компьютер нужно присоединить к домену.
1. Щелкните правой кнопкой Мой компьютер (My Computer) и выберите Свойства (Properties). Перейдите на вкладку Имя компьютера (Computer Name).
* В Панели управления выберите Система (System) и в диалоговом окне Свойства системы (System Properties) перейдите на вкладку Имя компьютера (Computer Name).
* Откройте окно свойств Имя компьютера (Computer Name). К свойствам компьютера на этой вкладке можно получить доступ несколькими способами.
Примечание В Windows 2000 вкладка Имя компьютера (Computer Name) называется Сетевая идентификация (Network Identification), а кнопка Изменить (Change) — Свойства (Properties). Тем не менее, работают они одинаково.
2. В Панели управления откройте Сетевые подключения (Network Connections) и в меню
Дополнительно (Advanced) выберите Сетевая идентификация (Network Identification).
3. На вкладке Имя компьютера (Computer Name) щелкните кнопку Изменить (Change). Диалоговое окно Изменение имени компьютера (Computer Name Changes) позволяет из
менить имя компьютера и его принадлежность к домену и рабочей группе (рис. 5-2).

   Нельзя изменять имя компьютера или его членство, если вы вошли в систему не с администраторскими реквизитами. Кнопка Изменить (Change) доступна только пользователям из локальной труппы Администраторы (Administrators).



Рис. 5-2. Диалоговое окно Изменение имени компьютера
4. В окне Изменение имени компьютера (Computer Name Changes) установите переключатель в положение домена (Domain) и введите нужное имя домена.
Совет Хотя нужный домен обычно можно найти по «плоскому» NetBIOS-имени, возьмите за правило вводить DNS-имя целевого домена. Конфигурация DNS жизненно важна для компьютера с Windows 2000/XP или Windows Server 2003. Используя для домена DNS-имя, вы активизируете предпочтительный процесс разрешения имен и проверяете конфигурацию DNS на данном компьютере. Если компьютер не сможет найти домен, к которому вы пытаетесь присоединить его, проверьте правильность параметров DNS-сервера, заданных в свойствах сетевого подключения.
5. Щелкните ОК. Компьютер попытается связаться с контроллером домена. Если связаться с доменом не удается, проверьте сетевые подключения и их параметры, а также конфигурацию DNS.

   Когда компьютер успешно свяжется с доменом, появится приглашение (рис. 5-3) для ввода имени пользователя и пароля, у которого есть привилегии присоединять компьютер к домену. Заметьте: запрошенные имя и пароль — это доменное имя и пароль.

 
Рис. 5-3. Запрос реквизитов пользователя для присоединения компьютера к домену
      
      Если в домене заранее не была создана учетная запись компьютера с тем же именем, во умолчанию Active Dkectory автоматически создаст такую учетную запись в контейнере Computers. После того как доменная учетная запись компьютера найдена или создана, компьютер установит доверительные отношения с доменом, изменит свой SID, чтобы он совпадал с SID этой доменной учетной записи, и изменит свое членство в группах. Для завершения процесса компьютер необходимо перезагрузить.
      Примечание Для присоединения рабочей станции или сервера к домену также можно применять команду NETDOM JOIN. Ее функции идентичны возможностям диалогового окна Изменение имени компьютера (Computer Name Changes), но она позволяет задать еще и ОП, в котором будет создана учетная запись, если соответствующего объекта компьютера еще нет в Active Dkectory.
      
      Сравнение контейнера Computers и ОП
      По умолчанию Active Dkectory помещает объекты компьютеров в контейнер Computers. После модернизации домена Windows NT 4 до Windows 2000 все учетные записи компьютеров сначала находятся в этом контейнере. Более того, если к домену присоединяется компьютер, для которого в этом домене еще нет учетной записи, объект компьютера создается автоматически.
      Совет. Комплект ресурсов Microsoft Windows Server 2003 содержит средство REDIRCOMP, позволяющее автоматически создавать объекты компьютеров в ОП по выбору, при этом домен должен обладать функциональными возможностями Windows Server 2003, то есть все его контроллеры должны работать под управлением этой ОС. Такое средство полезно для организаций, где создание учетных записей компьютеров контролируется не очень строго. Поскольку объекты компьютеров автоматически создаются в определенных ОП, ими можно управлять посредством политик, связанных с этими ОП. Подробное описание REDIRCOMP см. в документах по Комплекту ресурсов Windows Server 2003.
      Хотя по умолчанию объекты компьютеров помещаются в контейнер Computers, это не лучшее место для их хранения. В отличие от ОП, такие контейнеры, как Computers, Users и Builtin не могут быть связаны с политиками, ограничивающими возможную область действия групповой политики в отношении компьютеров. На практике стоит включить в структуру Active Directory минимум одно ОП для компьютеров. Обычно для компьютеров создают несколько ОП на основании структуры организации, местоположения компьютеров или назначения ОП, чтобы можно было отдельно администрировать ноутбуки, рабочие станции, серверы файлов, печати или приложений. Например, в Active Directory есть ОП, предназначенное по умолчанию для контроллеров домена, связанное с политикой Default Domain Controller Policy. Создавая в организации одно или несколько ОП для компьютеров, можно делегировать администрирование и более гибко управлять конфигурацией компьютеров через групповую политику.
      Если в организации создано одно или несколько ОП для компьютеров, вам придется перемещать все объекты компьютеров, автоматически создаваемые в контейнере Computers, в соответствующие ОП. Для перемещения отметьте нужный компьютер и в меню Действие (Action) выберите Переместить (Move). Кроме того, для перемещения можно использовать новую функцию перетаскивания (drag-and-drop) объектов, поддерживаемую ММС.
      Совет. Поскольку никакой объект компьютера в контейнере Computers не управляется групповыми политиками для ОП, выделенных для компьютеров, и поскольку необходимы дополнительные действия по переносу объекта компьютера из контейнера Computers в соответствующее ОП, рекомендуется создавать объекты компьютеров до присоединения к домену. Вы можете сначала создать объект компьютера в нужном ОП, чтобы сразу после присоединения к домену он управлялся политиками, связанными с данным ОП.
      Можно также перемещать объект компьютера или любой другой объект командой DSMOVE. Ее синтаксис таков:
      dsmove DN_объекта [-newname новое_имя] [-newparent DN_родителя]
      
      Параметр -newname позволяет переименовать объект. Параметр -newparent позволяет перемещать объект. Для перемещения компьютера DesktopABC из контейнера Computers в ОП Desktops введите следующую команду:
dsmove ?CN=DesktopABC, CN=Computers, DC=Contoso, DСcom? -newparent ?OU=Desktops, DC=Contoso, DCcom?

      В этой команде вы вновь видите отличие контейнера (CN) Computers от организационного подразделения (OU) Desktops.
      Для перемещения объектов в Active Directory необходимы соответствующие разрешения. По умолчанию членам группы Операторы учета (Account Operators) разрешается перемещать компьютеры между контейнерами, включая контейнер Computers, и любыми ОП, за исключением ОП Domain Controllers. Администраторы, включая членов групп Администраторы домена (Domain Admins) и Администраторы предприятия (Enterprise Admins), вправе перемещать объекты компьютеров между любыми контейнерами, включая контейнер Computers, ОП Domain Controllers и любые другие ОП.

      Закрепление материала
1. Каковы минимальные полномочия, необходимые для создания учетной записи компьютера с Windows Server 2003 в ОП в домене? Перечислите все этапы этого процесса. Считайте, что в Active Directory еще нет учетной записи для этого компьютера.
a. Администраторы домена (Domain Admins).
b. Администраторы предприятия (Enterprise Admins).
c. Администраторы (Administrators) на контроллере домена.
d. Операторы учета (Account Operators) на контроллере домена.
e. Операторы сервера (Server Operators) на контроллере домена.
f. Операторы учета (Account Operators) на данном сервере.
g. Операторы сервера (Server Operators) наданном сервере,
h. Администраторы (Administrators) на данном сервере.
2. Где в интерфейсе можно изменить членство компьютера под управлением Windows Server 2003 в домене?
a) Окно свойств Мой компьютер (My Computer).
b) Приложение Система (System) из Панели управления.
b) KoHcoxbActive Directory — пользователи и компьютеры (Active Directory Users AndмComputers).
c) Папка Сетевые подключения (Network Connections).
d) Приложение Пользователи (Users) из Панели управления.
3. Какая команда позволяют создать доменную учетную запись компьютера в Active Directory из командной строки?
a) NETDOM.
b) DSADD.
c) DSGET.
d) NETSH.
e) NSLOOKUP.
      
      Резюме
* Создавать объекты компьютеров в Active Directory по умолчанию разрешено членам группАдминистраторы (Administrators) и Операторы учета (Account Operators).
* Создавать учетные записи компьютеров можно с помощью консоли Active Directory — пользователи и компьютеры (Active Directory Users And Computers), атакже командами DSADD и NETDOM.
* Для изменения членства компьютера в домене необходимо войти в систему под учетной записью локальной группы Администраторы (Administrators).

      Занятие 8. Управление учетными записями компьютеров
      Управление разрешениями для объекта компьютера
      На занятии 1 вы узнали, что могли бы присоединить компьютер к домену, введя реквизиты администратора домена в ответ на запрос компьютера. Однако соображения безопасности требуют использовать для достижения конкретной цели минимальных полномочий, и привлечение учетной записи из группы Администраторы домена (Domain Admins) для добавления к домену рабочей станции выглядит стрельбой из пушки по воробьям.
      К счастью, Active Directory позволяет определить с высокой точностью, какие группы или пользователи вправе сопоставлять компьютер его доменной учетной записи. Хотя по умолчанию такой группой является Администраторы домена (Domain Admins), присоединять компьютер к доменной учетной записи можно разрешить любой группе, например с названием Installers. Легче всего это делать во время создания объекта компьютера.
      При создании объекта компьютера на первом шаге в окне Новый объект — Комтью-тер (New Object—Computer), показанном на рис. 5-1, отображается поле Присоединить к домену этот компьютер могут пользователь или группа пользователей, указанные ниже (The Following User Or Group Can Join This Computer To A Domain). Щелкните Изменить (Change), и вы сможете выбрать любого пользователя или группу и изменить для данного объекта набор разрешений.
      На следующем шаге в окне Новый объект — Компьютер потребуется ввести глобально уникальный идентификатор (GUID) добавляемого компьютера, который необходим при развертывании системы при помощи служб удаленной установки (Remote Installation Services, RIS). О службах RIS — в базе знаний Microsoft по адресу http:/'/support, microsoft, com.
      Если компьютер, который будет использовать создаваемую учетную запись, работает под управлением версии Windows младше 2000, установите флажок Назначить учетной записи статус пред-Windows 2000 компьютера (Assign This Computer Account As A Pre-Wtadows 2000 Computer). Если эта учетная запись предназначена для резервного контроллера домена Windows NT, установите флажок Назначить учетной записи статус резервного контроллера домена (Assign This Computer Account As A Backup Domain Controller).
      Совет Помните, что принадлежать домену могут только компьютеры, на которых установлена ОС на основе технологий Windows NT, поэтому компьютеры под управлением Windows 9x/Me не могут присоединяться к доменным учетным записям компьютеров или обрабатывать их. Поэтому данный флажок фактически подразумевает наличие Windows NT 4.
      
      Настройка свойств объекта компьютера
      Объекты компьютеров обладают некоторыми свойствами, которые не отображаются в пользовательском интерфейсе во время создания учетной записи компьютера. Откройте окно свойств для объекта компьютера, чтобы задать его расположение и описание, настроить членство в группах и разрешения удаленного доступа или связать его с объектом пользователя — владельца данного компьютера. Страница свойств Операционная система (Operating System) доступна только для чтения. Эта информация публикуется в Active Directory автоматически. Данная страница остаётся незаполненной, пока компьютер не присоединится к домену по этой учетной записи.
      Несколько классов объектов в Active Directory поддерживают свойство Manager, которое отображается на странице Управляется (Managed By) в окне свойств объекта компьютера. Это связанное свойство создает перекрестную ссылку на объект пользователя. Все остальные свойства (адреса и номера телефонов) не хранятся в самом объекте компьютера, а берутся напрямую из этого объекта пользователя.
Команда DSMOD, как говорилось в главе 2, также может изменять некоторые свойства объекта компьютера. В следующем разделе вы увидите работу команды DSMOD применительно к устранению неполадок с учетными записями компьютеров.
      Поиск и подключение к объектам в Active Directory
      При обращении пользователя вам может понадобиться информация о том, какая ОС и какой пакет обновления установлены на его компьютере. Как вы уже знаете, эта информация хранится в свойствах объекта компьютера. Так что остается только найти этот объект, что, впрочем, может быть непросто в структуре Active Directory с несколькими иоменами и множеством ОП.
      Консоль Active Directory — пользователи и компьютеры (Active Directory Users And Computers) предоставляет удобный доступ к мощному средству поиска с графическим интерфейсом. Это средство позволяет находить объекты многих типов. Здесь вы будете искать объект типа Computer. Щелкните кнопку Поиск объектов в службе каталогов Active Directory (Find Objects In Active Directory) на панели инструментов консоли. Откроется окно, показанное на рис. 5-4. Перед тем как щелкнуть Найти (Find Now), вы можете выбрать тип объекта в списке Найти (Find), область поиска в списке в (In) и указать условия поиска.

Рис. 5-4. Диалоговое окно Поиск: Компьютеры с результатами успешного поиска
      Перечень результатов позволяет выбрать объект и посредством меню Файл (File) или контекстного меню выполнить с выделенным объектом типичные операции. Многим администраторам нравится возможность открыть консоль Управление компьютером (Computer Management) по команде Управление (Manage) контекстного меню и напрямую подключиться к этому компьютеру, после чего работать на нем с журналами собы-тий,диспетчером устройств, информацией о системе, конфигурациями дисков и служб, а также локальными учетными записями пользователей и групп.

      Закрепление материала
1. Какие платформы можно присоединять к домену?
a. Windows 95.
b. Windows NT 4.
c. Windows 98.
d. Windows 2000.
e. Windows Me
f. Windows XP.
g. Windows Server 2003.
2. Вы открываете объект компьютера, но на вкладке Операционная система (Operating System) его окна свойств нет никакой информации. Почему значения свойств не отображаются?
3. У руководителя есть ноутбук с именем TopDog, на котором установлена Windows XP. Нужно разрешить этому компьютеру присоединяться к домену и гарантировать, что
бы на этот компьютер распространялись групповые политики, привязанные непосредственно к ОП Desktops. Как достичь этой цели?
4. Почему на практике обычно создают в домене учетную запись компьютера до его присоединения к домену?
      
      Резюме
• Любому пользователю или группе можно разрешить присоединять компьютер к доменной учетной записи при помощи свойства Присоединить к домену этот компьютермогут пользователь или группа пользователей, указанные ниже (The Following User Or Group Can Join This Computer To A Domain).
• Кнопка Поиск объектов в службе каталогов Active Directory (Find Objects In Active Directory) в консоли Active Directory - пользователи и компьютеры (Active Directory Users And Computers) позволяет находить и затем управлять компьютерами и другими объектами Active Directory.

      Занятие 9. Устранение неполадок с учетными записями компьютеров
      Домены Active Directory считают компьютеры участниками безопасности. Это значит, что у компьютера, как и у пользователя, есть учетная запись, или, точнее, свойства объекта компьютера: имя, пароль и SID. На этом занятии обсуждаются основные понятия, связанные с устранением неполадок объектов компьютеров.
Изучив материал этого занятия, вы сможете:
* понять различие между удалением, отключением и переустановкой учетных записей компьютеров;
* распознавать симптомы проблем с учетными записями компьютеров;
* устранять неполадки с учетными записями компьютеров путем их удаления, отключения, переустановки и повторного присоединения при помощи средств командной строки и средств с графическим интерфейсом.

     Удаление, отключение и переустановка учетных записей компьютеров
     Учетные записи компьютеров, как и учетные записи пользователей, обладают уникальным SID, позволяющим администратору предоставлять разрешения компьютерам. Как и учетные записи пользователей, компьютеры можно включать в группы. Следовательно, как и для учетных записей пользователей, важно понимать последствия удаления учетной записи компьютера. Когда учетная запись компьютера удаляется, его членство в группах и SID теряются. Если удаление было случайным, и с этим именем создается другая учетная запись компьютера, это будет совершено новая учетная запись с новым SID. Отношения с группами потребуется восстановить, и все разрешения, назначенные удаленному объекту компьютера, необходимо переназначить новой учетной записи. Удаляйте объекты компьютеров, только когда абсолютно уверены, что атрибуты безопасности этого объекта больше не понадобятся.
     Для удаления учетной записи компьютера в оснастке Active Directory - пользователи и компьютеры (Active Directory Users And Computers) щелкните нужный объект компьютера, а затем в меню Действие (Action) или, в контекстном меню выберите Удалил. (Delete). Вас попросят подтвердить удаление, и, поскольку это необратимая операция, ответом по умолчанию принято Нет (No). Щелкните Да (Yes), чтобы удалить объект.
     Команда DSRM, описанная в главе 3, позволяет удалить объект компьютера из командной строки:
DSRMDN_объекта
      Здесь DN_oбъекта - различающееся имя компьютера, например «CN=Desktop15, OU=Desktops, DC=contoso,DC=com». Снова появится запрос на подтверждение удаления.
      Совет. Когда компьютер отсоединяется от домена (например, если администратор присоединяет его к другой рабочей группе или домену), он пытается удалить свою учетную запись из домена. Если это нельзя сделать (из-за отсутствия связи, проблем с сетью или недостаточных разрешений), учетная запись остается в Active Directory. Она сразу или со временем будет отображаться как отключенная. Если эта учетная запись больше не нужна, удалите ее вручную.
      Если компьютер отключают от сети или не будет использоваться долгое время, его учетную запись можно отключить. Такое действие отвечает принципу безопасности, по которому список участников безопасности разрешает проверку подлинности только минимальному числу учетных записей, необходимому для решения задач организации. Отключение учетной записи не изменяет SID компьютера или его членство в группах, поэтому, когда компьютер подключат к сети, его учетную запись можно снова включить.
      В контекстном меню и в меню Действие (Action) для выбранного объекта компьютера предусмотрена команда Отключить учетную запись (Disable Account). Отключенные учетные записи обозначаются в оснастке Active Directory — пользователи и компьютеры (Active Directory Users And Computers) крестом (рис. 5-5).

 
Рис. 5-5. Отключенная учетная запись компьютера

      Когда учетная запись отключена, компьютер не может установить с доменом безопасную связь. В результате пользователи, ранее не входившие в систему на этом компьютере и реквизиты которых не были на нем кэшированы, не смогут входить в систему, пока учетная запись данного компьютера не будет включена и безопасный канал не будет восстановлен.
Для включения учетной записи компьютера просто выделите нужный компьютер и в меню Действие (Action) или в контекстном меню выберите команду Включить учетную вались (Enable Account).
      Отключать и включать компьютер из командной строки можно командой DSMOD, которая изменяет объекты Active Directory:
      DSMOD COMPUTER DN_ компьютера -DISABLED YES 
      DSMOD COMPUTER DN_компьютера -DISABLED NO
      
      Если членство в группах и SID учетной записи компьютера, а также разрешения, назначенные этому SID, важны для функционирования домена, не следует удалять такую учетную запись. Что же делать, если компьютер заменяется новой системой с современным оборудованием? Это одна из ситуаций, когда может понадобиться переустановка учетной записи компьютера.
      При переустановке учетной записи компьютера пароль на вход удаляется, но сохраняются все остальные свойства объекта. Без пароля данная учетная запись фактически становится «доступной» для использования. Любой компьютер теперь может присоединиться к домену по этой учетной записи, в том числе ваша новая система.
      На самом деле компьютер, который уже был присоединен к домену с этой учетной записью, тоже может использовать переустановленную запись, просто ему нужно повторно присоединиться к этому домену. Эти ситуации будут подробно рассмотрены в практикуме по устранению неполадок.
      Команда Переустановить учетную запись (Reset Account) доступна для выбранного объекта компьютера в меню Действие (Action) и в контекстном меню. Для переустановки учетной записи компьютера также можно применять команду DSMOD:
      DSMOD computer DN_компьютера -reset
Команда NETDOM, входящая в средства поддержки Windows Server 2003 (папка Support\Tools на установочном компакт-диске), также позволяет переустановить учетную запись компьютера.
      
      Выявление проблем с учетными записями компьютеров
      Учетные записи компьютеров и безопасные отношения между компьютерами и их доменом работают весьма надежно. В редких случаях, когда учетная запись или безопасный канал перестают функционировать, признаки такой неполадки вполне очевидны. Наиболее типичные признаки проблем с учетными записями компьютеров таковы: 
* сообщения при входе в систему о том, что связь с контроллером домена не может быть установлена, отсутствует учетная запись для данного компьютера или доверительные (то есть безопасные) отношения между компьютером и доменом были потеряны (см. пример на рис. 5-6);


Рис. 5-6. Сообщение, выдаваемое клиентом Windows XP при входе в систему, о возможных проблемах с учетной записью компьютера

* сообщения об ошибках или записи в журнале событий о подобных проблемах или предположения об ошибке паролей, доверительных отношений, безопасных каналов или отношений с доменом или контроллером домена;
* отсутствие учетной записи компьютера в Active Directory.
   
      В каждой из таких ситуаций необходимо устранить проблему с учетной записью. Вы уже знаете, как удалять, отключать и переустанавливать учетную запись компьютера, а также как присоединять компьютер к домену.
      При устранении неполадок с учетными записями компьютеров придерживайтесь следующих правил.
A. Если данная учетная запись компьютера существует в Active Directory, ее нужно переустановить.
B. Если данной учетной записи компьютера нет в Active Directory, ее нужно создать.
C. Если компьютер еще принадлежит домену, его нужно удалить из домена, включив в какую-либо рабочую группу. Имя рабочей группы не имеет значения. Лучше всего методом проб найти имя, которое точно не используется.
D. Снова присоединить этот компьютер к домену; или присоединить другой компьютер, но его имя должно совпадать с именем данной учетной записи.

      Для устранения любой неполадки с учетной записью компьютера применяйте все четыре правила. Они могут применяться в произвольном порядке, за исключением правила D, связанного с присоединением компьютера к домену, — эту операцию выполняйте в последнюю очередь. Рассмотрим две ситуации.
      В первой ситуации пользователь жалуется: при попытке входа в систему выдается сообщение, что учетная запись для данного компьютера, возможно, отсутствует. Применяя правило А, вы открываете консоль Active Directory — пользователи и компьютеры (Active Directory Users And Computers) и обнаруживаете, что данная учетная запись существует. Вы переустанавливаете учетную запись. Правило В не применяется — учетная запись существует. Затем, согласно правилу С, вы отсоединяете данную систему от домена, после чего по правилу D снова присоединяете ее.
      Во второй ситуации предположим, что учетная запись компьютера переустановлена случайно, тогда сначала применим правило А. Хотя переустановка и случайна, необходимо продолжить восстановление согласно остальным трем правилам. Правило В не применяется, поскольку данная учетная запись существует в домене. Правило С говорит, что раз компьютер еще присоединен к домену, его нужно удалить из домена, а затем, по правилу D, снова присоединить.
      По этим четырем правилам вы сможете, как на работе, так и на экзамене, принять осознанное решение о том, как поступить в каждой ситуации сбоя функционирования учетной записи компьютера.

      Закрепление материала
1. Ваша организация расширилась и создала второй домен. В последние выходные несколько компьютеров из вашего домена были переведены в новый домен. Открыв консоль Active Directory — пользователи и компьютеры (Active Directory Users And Computers), вы видите, что эти компьютеры все еще отображаются в вашем домене, но помечены красным крестом «Х». Какие действия лучше всего предпринять?
a. Включить эти учетные записи.
b. Отключить эти учетные записи.
c. Переустановить эти учетные записи.
d. Удалить эти учетные записи.
2. Пользователь жалуется: при попытке входа в систему появляется сообщение, что данный компьютер не может связаться с доменом, потому что контроллер домена выключен или учетная запись для данного компьютера отсутствует. Открыв консоль Active Directory — пользователи и компьютеры (Active Directory Users And Computers), вы видите, что учетной записи этого компьютера действительно нет. Что следует предпринять?
3. Пользователь жалуется: при попытке входа в систему появляется сообщение, что данный компьютер не может связаться с доменом, потому что контроллер домена выключен или учетная запись для данного компьютера отсутствует. Открыв консоль Active Directory — пользователи и компьютеры (Active Directory Users And Computers), вы видите, что учетная запись этого компьютера в порядке. Что следует предпринять?
      Резюме
* Для компьютеров существуют учетные записи, которые, как и учетные записи пользователей, содержат SID и описывают членство в группах. Будьте осторожны при
удалении объектов компьютеров. Отключение объектов компьютеров позволяет включить эти объекты снова, если потребуется присоединить соответствующий компьютер к домену.
* Проблемы с учетными записями компьютеров обычно вполне очевидны: выводятся сообщения или регистрируются события о том, что есть неполадки с учетной записью, паролем, безопасным каналом или доверительными отношениями.
11


